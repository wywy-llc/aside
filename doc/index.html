<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GASé–‹ç™ºã‚¿ãƒ¼ãƒœåŒ–è¨ˆç”» v3.0ï¼šå®Œå…¨ç‰ˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ & è§£èª¬</title>
    <style>
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 900px;
        margin: 20px auto;
        padding: 40px;
        background-color: #ffffff;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
      }
      h1 {
        text-align: center;
        font-size: 2.2em;
        color: #1a73e8;
        border-bottom: 3px solid #1a73e8;
        padding-bottom: 15px;
        margin-bottom: 40px;
      }
      h2 {
        font-size: 1.6em;
        color: #202124;
        border-left: 5px solid #1a73e8;
        padding-left: 15px;
        margin-top: 40px;
        margin-bottom: 20px;
      }
      h3 {
        font-size: 1.3em;
        color: #1a73e8;
        margin-top: 25px;
      }
      p,
      li {
        color: #5f6368;
      }
      .section {
        margin-bottom: 30px;
      }
      .highlight-box {
        background-color: #e8f0fe;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #d2e3fc;
        margin: 20px 0;
      }
      .warning-box {
        background-color: #fce8e6;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #fad2cf;
        margin: 20px 0;
        color: #c5221f;
      }
      .highlight-title {
        font-weight: bold;
        color: #1967d2;
        margin-bottom: 5px;
        display: block;
      }
      .warning-title {
        font-weight: bold;
        color: #c5221f;
        margin-bottom: 5px;
        display: block;
      }
      .merit-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }
      .setup-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }
      .merit-card {
        background: #fff;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
        transition: transform 0.2s;
      }
      .merit-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        border-color: #1a73e8;
      }
      .setup-card {
        background: #f8f9fa;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        padding: 15px;
      }
      .merit-icon {
        font-size: 2em;
        margin-bottom: 10px;
        display: block;
      }
      .tag {
        display: inline-block;
        font-size: 0.75em;
        padding: 2px 8px;
        border-radius: 12px;
        margin-bottom: 10px;
        font-weight: bold;
      }
      .tag-platform {
        background-color: #e6f4ea;
        color: #137333;
      }
      .tag-tech {
        background-color: #e8f0fe;
        color: #1967d2;
      }
      .tag-arch {
        background-color: #fff8e1;
        color: #f57f17;
      } /* Yellow/Orange */

      table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }
      th,
      td {
        padding: 15px;
        text-align: left;
        border-bottom: 1px solid #eee;
      }
      th {
        background-color: #f8f9fa;
        color: #202124;
        font-weight: 600;
      }
      code {
        background-color: #f1f3f4;
        padding: 2px 6px;
        border-radius: 4px;
        font-family: 'Roboto Mono', monospace;
        color: #d93025;
        font-size: 0.9em;
      }
      pre {
        background-color: #2d2d2d;
        color: #f8f8f2;
        padding: 15px;
        border-radius: 8px;
        overflow-x: auto;
        font-family: 'Roboto Mono', monospace;
        font-size: 0.9em;
      }
      ul {
        padding-left: 20px;
      }

      /* Arch Diagram Styles */
      .arch-grid {
        display: grid;
        grid-template-columns: 1fr 0.2fr 1fr;
        grid-template-rows: auto 0.2fr auto;
        gap: 10px;
        background: #f4f6f8;
        padding: 30px;
        border-radius: 12px;
        margin: 30px 0;
        border: 1px solid #e1e4e8;
      }
      .arch-box {
        background: white;
        padding: 20px;
        border-radius: 10px;
        border: 2px solid transparent;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        position: relative;
        min-height: 140px;
        display: flex;
        flex-direction: column;
      }
      .arch-box h4 {
        margin: 0 0 10px 0;
        font-size: 1.1em;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .arch-box p {
        font-size: 0.9em;
        margin: 0;
        color: #666;
      }
      .arch-box ul {
        margin: 10px 0 0 0;
        padding-left: 20px;
        font-size: 0.85em;
        color: #444;
      }
      .role-human {
        border-color: #4285f4;
      }
      .role-human h4 {
        color: #1967d2;
      }
      .role-gemini {
        border-color: #aa47bc;
      }
      .role-gemini h4 {
        color: #7b1fa2;
      }
      .role-env {
        border-color: #34a853;
      }
      .role-env h4 {
        color: #137333;
      }
      .role-mcp {
        border-color: #fbbc04;
      }
      .role-mcp h4 {
        color: #b06000;
      }

      .arrow-container {
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        text-align: center;
      }
      .arrow-text {
        background: #fff;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 0.75em;
        color: #555;
        border: 1px solid #ddd;
        position: absolute;
        z-index: 1;
        white-space: nowrap;
      }
      .arrow-line {
        width: 100%;
        height: 2px;
        background: #ccc;
        position: relative;
      }
      .arrow-line::after {
        content: 'â–¶';
        position: absolute;
        right: -5px;
        top: -7px;
        color: #ccc;
        font-size: 12px;
      }
      .arrow-vertical .arrow-line {
        width: 2px;
        height: 100%;
      }
      .arrow-vertical .arrow-line::after {
        right: -5px;
        bottom: -5px;
        top: auto;
        transform: rotate(90deg);
      }
      .arrow-left .arrow-line::after {
        left: -5px;
        right: auto;
        transform: rotate(180deg);
      }

      .area-human {
        grid-area: 1 / 1 / 2 / 2;
      }
      .area-gemini {
        grid-area: 1 / 3 / 2 / 4;
      }
      .area-env {
        grid-area: 3 / 1 / 4 / 2;
      }
      .area-mcp {
        grid-area: 3 / 3 / 4 / 4;
      }
      .conn-top {
        grid-area: 1 / 2 / 2 / 3;
      }
      .conn-left {
        grid-area: 2 / 1 / 3 / 2;
      }
      .conn-right {
        grid-area: 2 / 3 / 3 / 4;
      }
      .conn-bottom {
        grid-area: 3 / 2 / 4 / 3;
      }

      /* MCP Internal Logic Styles */
      .mcp-logic-container {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        background: #fff;
        padding: 25px;
        border: 1px dashed #aaa;
        border-radius: 8px;
        margin-top: 20px;
      }
      .logic-step {
        text-align: center;
        flex: 1;
        padding: 10px;
        min-height: 180px;
      }
      .logic-icon {
        font-size: 2em;
        display: block;
        margin-bottom: 10px;
      }
      .logic-arrow {
        font-size: 1.5em;
        color: #ccc;
        align-self: center;
        margin-top: 50px;
      }
      .logic-label {
        font-weight: bold;
        display: block;
        margin-bottom: 8px;
        color: #444;
      }
      .logic-sub {
        font-size: 0.8em;
        color: #666;
        margin-bottom: 8px;
        display: block;
      }
      .code-box {
        background: #2d2d2d;
        color: #f8f8f2;
        padding: 10px;
        border-radius: 6px;
        text-align: left;
        font-family: 'Roboto Mono', monospace;
        font-size: 0.75em;
        border-left: 3px solid;
        margin-bottom: 5px;
      }
      .box-blue {
        border-color: #4285f4;
      }
      .box-red {
        border-color: #db4437;
      }
      .file-list {
        text-align: left;
        font-size: 0.8em;
        list-style: none;
        padding: 0;
        margin: 0 auto;
        display: inline-block;
      }
      .file-list li {
        margin-bottom: 4px;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      /* Reference Section Styles */
      .ref-concept {
        display: flex;
        gap: 20px;
        align-items: center;
        background: #f9f9f9;
        padding: 20px;
        border-radius: 8px;
        border-left: 5px solid #666;
        margin-bottom: 20px;
      }
      .ref-text {
        flex: 1;
      }
      .ref-code-block {
        background: #222;
        color: #fff;
        padding: 15px;
        border-radius: 5px;
        font-family: 'Roboto Mono', monospace;
        font-size: 0.85em;
        overflow-x: auto;
      }
      .comment {
        color: #6a9955;
      }
      .keyword {
        color: #569cd6;
      }
      .type {
        color: #4ec9b0;
      }
    </style>
  </head>
  <body>
    <h1>GASé–‹ç™ºã‚¿ãƒ¼ãƒœåŒ–è¨ˆç”» v3.0ï¼šå®Œå…¨ç‰ˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ & è§£èª¬</h1>

    <div class="section">
      <h2>1. ä¼ç”»æ¦‚è¦</h2>
      <p>
        æœ¬ä¼ç”»ã¯ã€Google Apps Script (GAS)
        é–‹ç™ºã«ãŠã‘ã‚‹ã€Œå£Šã‚Œã‚„ã™ã•ã€ã¨ã€Œãƒ†ã‚¹ãƒˆã®ã—ã«ãã•ã€ã‚’ã€
        <strong
          >ã€Œåå‰ä»˜ãç¯„å›²ã®æ¨™æº–åŒ–ã€ã¨ã€Œãƒ­ãƒ¼ã‚«ãƒ«/æœ¬ç•ª ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å®Ÿè¡Œã€</strong
        >ã§è§£æ±ºã™ã‚‹ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚<br />
        AIï¼ˆLocal
        MCPï¼‰ãŒã‚¤ãƒ³ãƒ•ãƒ©ç®¡ç†ã®ã€Œãƒ­ãƒœãƒƒãƒˆã‚¢ãƒ¼ãƒ ã€ã¨ã—ã¦åƒãã“ã¨ã§ã€äººé–“ã¯é¢å€’ãªè¨­å®šä½œæ¥­ã‹ã‚‰è§£æ”¾ã•ã‚Œã¾ã™ã€‚
      </p>
    </div>

    <div class="section">
      <h2>2. è§£æ±ºã™ã‚‹èª²é¡Œã¨ãƒ¡ãƒªãƒƒãƒˆ</h2>
      <div class="merit-grid">
        <div class="merit-card">
          <span class="tag tag-platform">Platform</span>
          <span class="merit-icon">ğŸ’°</span>
          <h3>å®Œå…¨ç„¡æ–™ & ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹</h3>
          <p>
            Googleã®å¼·åŠ›ãªã‚¤ãƒ³ãƒ•ãƒ©ã‚’ä½¿ã„ã€ã‚µãƒ¼ãƒãƒ¼ä»£ã‚¼ãƒ­ã§ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªã‚¢ãƒ—ãƒªã‚’é‹ç”¨ã€‚
          </p>
        </div>
        <div class="merit-card">
          <span class="tag tag-arch">Architecture</span>
          <span class="merit-icon">ğŸ›¡ï¸</span>
          <h3>åå‰ä»˜ãç¯„å›²ã«ã‚ˆã‚‹å …ç‰¢åŒ–</h3>
          <p>
            ã€ŒCåˆ—ã€ã®ã‚ˆã†ãªä½ç½®æŒ‡å®šã‚’ç¦æ­¢ã€‚AIãŒå¯¾è©±çš„ã«ã€Œåå‰ä»˜ãç¯„å›²ã€ã‚’è¨­å®šã—ã€åˆ—ã®ç§»å‹•ã‚„æŒ¿å…¥ãŒã‚ã£ã¦ã‚‚å£Šã‚Œãªã„ã‚³ãƒ¼ãƒ‰ã‚’ä¿è¨¼ã—ã¾ã™ã€‚
          </p>
        </div>
        <div class="merit-card">
          <span class="tag tag-tech">AI Agent</span>
          <span class="merit-icon">ğŸ¤–</span>
          <h3>AIè‡ªå¾‹é–‹ç™º</h3>
          <p>
            é¢å€’ãªç’°å¢ƒæ§‹ç¯‰ã€å‹å®šç¾©ã€ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆè¨˜è¿°ã¯AIã«ãŠä»»ã›ã€‚äººé–“ã¯ã€Œãƒ­ã‚¸ãƒƒã‚¯ã€ã«é›†ä¸­ã€‚
          </p>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>3. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ§‹æˆå›³</h2>

      <h3>3.1 Human-AI Interaction Loop</h3>
      <p>äººé–“ã¨AIã€ãã—ã¦å®Ÿè¡Œç’°å¢ƒãŒã©ã®ã‚ˆã†ã«é€£æºã™ã‚‹ã‹ã‚’ç¤ºã—ãŸå…¨ä½“å›³ã§ã™ã€‚</p>

      <div class="arch-grid">
        <div class="arch-box role-human area-human">
          <h4>ğŸ‘¨â€ğŸ’» äººé–“ (é–‹ç™ºè€…)</h4>
          <p><strong>å½¹å‰²:</strong> æ„æ€æ±ºå®š & ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…</p>
          <ul>
            <li>VS Codeã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°</li>
            <li>Geminiã¸ã®æŒ‡ç¤ºå‡ºã—</li>
            <li>ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</li>
          </ul>
        </div>

        <div class="arrow-container conn-top">
          <div class="arrow-text">
            è‡ªç„¶è¨€èªã§æŒ‡ç¤º<br />"å£²ä¸Šé›†è¨ˆæ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦"
          </div>
          <div class="arrow-line"></div>
        </div>

        <div class="arch-box role-gemini area-gemini">
          <h4>âœ¨ Gemini (AI Agent)</h4>
          <p><strong>å½¹å‰²:</strong> æ„å›³ç†è§£ & ãƒ„ãƒ¼ãƒ«é¸å®š</p>
          <ul>
            <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ„å›³ã‚’è§£æ</li>
            <li>MCPãƒ„ãƒ¼ãƒ«(scaffoldç­‰)ã‚’é¸æŠ</li>
            <li>ã€Œä½•ã‚’ã™ã‚‹ã‹ã€ã‚’MCPã¸å‘½ä»¤</li>
          </ul>
        </div>

        <div class="arrow-container conn-left arrow-vertical">
          <div class="arrow-text">ãƒ­ãƒ¼ã‚«ãƒ«ã§å³<br />å‹•ä½œç¢ºèª</div>
          <div class="arrow-line"></div>
        </div>

        <div class="arrow-container conn-right arrow-vertical">
          <div class="arrow-text">Tool Call<br />(scaffold_feature)</div>
          <div class="arrow-line"></div>
        </div>

        <div class="arch-box role-env area-env">
          <h4>ğŸ“ ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰é–‹ç™ºç’°å¢ƒ</h4>
          <p><strong>å½¹å‰²:</strong> ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å®Ÿä½“</p>
          <ul>
            <li><code>src/app/</code> (Logic)</li>
            <li><code>src/infra/</code> (Adapters)</li>
            <li><code>dist/</code> (GAS Artifacts)</li>
          </ul>
        </div>

        <div class="arrow-container conn-bottom arrow-left">
          <div class="arrow-text">ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ<br />è¨­å®šæ›´æ–°</div>
          <div class="arrow-line"></div>
        </div>

        <div class="arch-box role-mcp area-mcp">
          <h4>âš™ï¸ ãƒ­ãƒ¼ã‚«ãƒ«MCP</h4>
          <p><strong>å½¹å‰²:</strong> ãƒ­ãƒœãƒƒãƒˆã‚¢ãƒ¼ãƒ  (å®Ÿè¡Œ)</p>
          <ul>
            <li>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³</li>
            <li>ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ (fs)</li>
            <li>APIæ“ä½œ (googleapis)</li>
          </ul>
        </div>
      </div>

      <h3>3.2 MCPå†…éƒ¨ã®å‡¦ç†ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼šHybrid Code Generator</h3>
      <p>
        ä»Šå›ã®MCPã®å½¹å‰²ã¯ã€å˜ãªã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br />
        <strong
          >ã€Œ1ã¤ã®æŒ‡ç¤ºã€ã‹ã‚‰ã€Œ2ã¤ã®ç’°å¢ƒ(GAS/Local)ç”¨ã®ã‚³ãƒ¼ãƒ‰ã€ã‚’åŒæ™‚ã«ç”Ÿæˆã—ã€æ•´åˆæ€§ã‚’æ‹…ä¿ã™ã‚‹</strong
        >
        ã‚¹ã‚«ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ³ã®æŒ™å‹•ã§ã™ã€‚
      </p>

      <div class="mcp-logic-container">
        <div class="logic-step">
          <span class="logic-icon">ğŸ“¥</span>
          <span class="logic-label">1. Input (Tool Call)</span>
          <span class="logic-sub">Geminiã‹ã‚‰ã®å‘½ä»¤</span>
          <div class="code-box">
            { "feature": "Sales", "range": "RANGE_SALES" }
          </div>
          <p style="font-size: 0.8em; margin-top: 5px">
            ã€Œå£²ä¸Š(Sales)æ©Ÿèƒ½ã‚’ã€RANGE_SALESå®šæ•°ã‚’ä½¿ã£ã¦ä½œã‚Œã€
          </p>
        </div>

        <div class="logic-arrow">â¡</div>

        <div class="logic-step" style="background: #fff8e1; border-radius: 8px">
          <span class="logic-icon">âš™ï¸</span>
          <span class="logic-label">2. Process (Engine)</span>
          <span class="logic-sub">ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰å±•é–‹</span>
          <div class="code-box box-blue">
            LocalTmpl.replace(...)<br />
            â†³ uses 'googleapis'
          </div>
          <div class="code-box box-red">
            GasTmpl.replace(...)<br />
            â†³ uses 'SpreadsheetApp'
          </div>
          <p style="font-size: 0.8em; margin-top: 5px">
            ç’°å¢ƒã”ã¨ã®å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã‚’ä¸¦è¡Œç”Ÿæˆ
          </p>
        </div>

        <div class="logic-arrow">â¡</div>

        <div class="logic-step">
          <span class="logic-icon">ğŸ“‚</span>
          <span class="logic-label">3. Output (Files)</span>
          <span class="logic-sub">ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¸æ›¸ãè¾¼ã¿</span>
          <ul class="file-list">
            <li>ğŸŸ¡ <code>ISalesRepo.ts</code> (IF)</li>
            <li>ğŸ”µ <code>LocalSalesRepo.ts</code> (Node)</li>
            <li>ğŸ”´ <code>GasSalesRepo.ts</code> (GAS)</li>
          </ul>
          <p style="font-size: 0.8em; margin-top: 5px">
            ã“ã®ç¬é–“ã‹ã‚‰ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã«ï¼
          </p>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>4. MCPã‚µãƒ¼ãƒãƒ¼ãŒæä¾›ã™ã‚‹æ©Ÿèƒ½ (The Big 3)</h2>
      <p>
        AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆMCPï¼‰ã¯ä»¥ä¸‹ã®3ã¤ã®ã€Œé¢å€’ã ãŒé‡è¦ãªã‚¿ã‚¹ã‚¯ã€ã‚’å°‚ä»»ã—ã¾ã™ã€‚
      </p>

      <table>
        <thead>
          <tr>
            <th style="width: 25%">Toolå</th>
            <th style="width: 20%">ã‚«ãƒ†ã‚´ãƒª</th>
            <th>æ©Ÿèƒ½è©³ç´°</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>setup_named_range</code></td>
            <td>
              <span class="tag tag-arch" style="margin: 0">Infrastructure</span>
            </td>
            <td>
              <strong>å¯¾è©±å‹ãƒ»ç¯„å›²å®šç¾©ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰</strong><br />
              AIãŒå®Ÿéš›ã®ã‚·ãƒ¼ãƒˆã‚’è¦‹ãªãŒã‚‰ã€Œå£²ä¸Šãƒ‡ãƒ¼ã‚¿ã¯ã©ã®åˆ—ã§ã™ã‹ï¼Ÿã€ã¨é–‹ç™ºè€…ã«ãƒ’ã‚¢ãƒªãƒ³ã‚°ã€‚<br />
              å›ç­”ã«åŸºã¥ãã€Google Sheets
              APIçµŒç”±ã§<strong>ã€Œåå‰ä»˜ãç¯„å›²ã€ã‚’è‡ªå‹•è¨­å®š</strong>ã—ã€åŒæ™‚ã«ã‚³ãƒ¼ãƒ‰å´ã®å®šæ•°å®šç¾©ï¼ˆ<code
                >const RANGE_SALES = 'SalesData'</code
              >ï¼‰ã‚‚æ›´æ–°ã™ã‚‹ã€‚
            </td>
          </tr>
          <tr>
            <td><code>scaffold_feature</code></td>
            <td><span class="tag tag-tech" style="margin: 0">Coding</span></td>
            <td>
              <strong>å …ç‰¢ãªã‚³ãƒ¼ãƒ‰ã®ä¸€æ‹¬ç”Ÿæˆ</strong><br />
              å®šç¾©ã•ã‚ŒãŸåå‰ä»˜ãç¯„å›²ã‚’åˆ©ç”¨ã™ã‚‹ Repositoryï¼ˆInterface / GASç‰ˆ /
              Localç‰ˆï¼‰ã¨ UseCase ã®é››å½¢ã‚’ä¸€æ’ƒã§ä½œæˆã€‚<br />
              ã€Œç›´æ›¸ãã€ã«ã‚ˆã‚‹è¨­è¨ˆã®å´©ã‚Œã‚’æœªç„¶ã«é˜²ãã€‚
            </td>
          </tr>
          <tr>
            <td><code>sync_local_secrets</code></td>
            <td>
              <span class="tag tag-platform" style="margin: 0">Setup</span>
            </td>
            <td>
              <strong>ç’°å¢ƒæ§‹ç¯‰ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</strong><br />
              GCPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã€APIæœ‰åŠ¹åŒ–ãƒã‚§ãƒƒã‚¯ã€JSONéµé…ç½®ã€<code>.gitignore</code>ç¢ºèªã‚’è‡ªå‹•åŒ–ã€‚<br />
              ã€Œãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ã‹ãªã„ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚’ã‚¼ãƒ­ã«ã™ã‚‹ã€‚
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="section">
      <h2>5. ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œã®ãŸã‚ã®ã‚¤ãƒ³ãƒ•ãƒ©æº–å‚™ (One-time Setup)</h2>
      <div class="setup-grid">
        <div class="setup-card">
          <strong>1. GCPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</strong>
          <p style="font-size: 0.9em; margin-top: 5px">
            GASç´ä»˜ã‘ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”¨æ„
          </p>
        </div>
        <div class="setup-card">
          <strong>2. APIæœ‰åŠ¹åŒ–</strong>
          <p style="font-size: 0.9em; margin-top: 5px">Google Sheets APIã‚’ON</p>
        </div>
        <div class="setup-card">
          <strong>3. ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</strong>
          <p style="font-size: 0.9em; margin-top: 5px">JSONéµã‚’ä½œæˆ & DL</p>
        </div>
        <div class="setup-card">
          <strong>4. æ¨©é™ä»˜ä¸</strong>
          <p style="font-size: 0.9em; margin-top: 5px">
            Botãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ‹›å¾…
          </p>
        </div>
      </div>
      <div class="warning-box">
        <span class="warning-title">âš ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</span>
        JSONéµã¯
        <code>.gitignore</code>
        ã«è¿½åŠ ã—ã€çµ¶å¯¾ã«ãƒªãƒã‚¸ãƒˆãƒªã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ã§ãã ã•ã„ã€‚
      </div>
    </div>

    <div class="section">
      <h2>7. å‚è€ƒè³‡æ–™ï¼šãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³å¾¹åº•è§£èª¬</h2>
      <p>
        æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ¡ç”¨ã—ã¦ã„ã‚‹ã€Œãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã€ã¯ã€å°‘ã—é›£ã—ãè¦‹ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€
        <strong
          >ã€Œã‚„ã‚ŠãŸã„ã“ã¨ï¼ˆãƒ­ã‚¸ãƒƒã‚¯ï¼‰ã€ã¨ã€Œãƒ‡ãƒ¼ã‚¿ã®å–ã‚Šæ–¹ï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ï¼‰ã€ã‚’åˆ‡ã‚Šé›¢ã™</strong
        >ãŸã‚ã®è¨­è¨ˆã§ã™ã€‚
      </p>

      <div class="ref-concept">
        <div class="ref-text">
          <h3>ğŸ”„ ãªãœåˆ†é›¢ã™ã‚‹ã®ã‹ï¼Ÿ</h3>
          <p>
            é€šå¸¸ã®GASé–‹ç™ºã§ã¯ã€ãƒ­ã‚¸ãƒƒã‚¯ã®ä¸­ã«ç›´æ¥
            <code>SpreadsheetApp</code> ã‚’æ›¸ã„ã¦ã—ã¾ã„ã¾ã™ã€‚
            ã“ã‚Œã ã¨ã€ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼ˆNode.jsï¼‰ã§å‹•ã‹ãã†ã¨ã—ãŸæ™‚ã«ã€ã€ŒSpreadsheetAppãªã‚“ã¦çŸ¥ã‚‰ãªã„ã‚ˆã€ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã€ãƒ†ã‚¹ãƒˆãŒã§ãã¾ã›ã‚“ã€‚
          </p>
          <p>
            ãã“ã§ã€é–“ã«ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€ã¨ã„ã†å¥‘ç´„æ›¸ã‚’æŒŸã¿ã¾ã™ã€‚
            <strong
              >ã€Œã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¹ã°ãƒ‡ãƒ¼ã‚¿ãŒè¿”ã‚‹ã€ã¨ã„ã†ç´„æŸã ã‘ã‚’å…±æœ‰</strong
            >ã—ã€è£å´ã®ä»•çµ„ã¿ã‚’ç’°å¢ƒã«ã‚ˆã£ã¦å·®ã—æ›¿ãˆã‚‹ã®ã§ã™ã€‚
          </p>
        </div>
      </div>

      <h3>ğŸ“ ã‚³ãƒ¼ãƒ‰ã§ã®æ¯”è¼ƒ</h3>

      <h4>âŒ å¾“æ¥ã®æ›¸ãæ–¹ (å¯†çµåˆ)</h4>
      <div class="ref-code-block" style="border: 1px solid #db4437">
        <span class="keyword">function</span> calculateTotal() {
        <span class="comment"
          >// ã“ã“ã§GASã®æ©Ÿèƒ½ã«ä¾å­˜ã—ã¦ã„ã‚‹ãŸã‚ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œä¸å¯èƒ½ï¼</span
        >
        <span class="keyword">const</span> data =
        SpreadsheetApp.getActive().getRange("A1:B10").getValues();
        <span class="comment">// è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯...</span>
        }
      </div>

      <br />

      <h4>âœ… ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ›¸ãæ–¹ (ç–çµåˆ)</h4>
      <div class="ref-code-block" style="border: 1px solid #4285f4">
        <span class="comment">// 1. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (ç´„æŸäº‹)</span>
        <span class="keyword">interface</span>
        <span class="type">ISalesRepo</span> { getSalesData():
        Promise&lt;any[][]&gt;; }

        <span class="comment">// 2. ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ (ç’°å¢ƒã‚’çŸ¥ã‚‰ãªã„)</span>
        <span class="keyword">async function</span> calculateTotal(repo:
        <span class="type">ISalesRepo</span>) {
        <span class="comment"
          >// ã©ã“ã‹ã‚‰æ¥ã‚‹ã‹æ°—ã«ã›ãšã€ç´„æŸé€šã‚Šãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶ã ã‘</span
        >
        <span class="keyword">const</span> data =
        <span class="keyword">await</span> repo.getSalesData();
        <span class="comment"
          >// è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯... (ã“ã“ã¯ç´”ç²‹ãªTypeScriptãªã®ã§ã©ã“ã§ã‚‚å‹•ãï¼)</span
        >
        }

        <span class="comment">// 3. å®Ÿè£… (ç’°å¢ƒã”ã¨ã«ç”¨æ„)</span>
        <span class="keyword">class</span>
        <span class="type">GasSalesRepo</span>
        <span class="keyword">implements</span>
        <span class="type">ISalesRepo</span> { ... }
        <span class="comment">// SpreadsheetAppã‚’ä½¿ç”¨</span>
        <span class="keyword">class</span>
        <span class="type">LocalSalesRepo</span>
        <span class="keyword">implements</span>
        <span class="type">ISalesRepo</span> { ... }
        <span class="comment">// googleapisã‚’ä½¿ç”¨</span>
      </div>

      <p style="margin-top: 20px">
        ã“ã®ã‚ˆã†ã«è¨˜è¿°é‡ãŒå¢—ãˆã‚‹ã®ãŒå”¯ä¸€ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã§ã™ãŒã€æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯
        <strong
          >MCPã®
          <code>scaffold_feature</code>
          ãŒã“ã‚Œã‚‰ã®ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ãŸã‚ã€ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¯äº‹å®Ÿä¸Šã‚¼ãƒ­</strong
        >ã«ãªã‚Šã¾ã™ã€‚
      </p>
    </div>
  </body>
</html>
